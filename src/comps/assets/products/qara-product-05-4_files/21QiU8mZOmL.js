(function(d){var c=window.AmazonUIPageJS||window.P,g=c._namespace||c.attributeErrors,b=g?g("ARARegisterTrigger",""):c;b.guardFatal?b.guardFatal(d)(b,window):b.execute(function(){d(b,window)})})(function(d,c,g){d.now("ARAConfiguration").execute(function(b){b||d.register("ARAConfiguration",function(){return{getRoboticSessionId:function(){return"000-0000000-0000000"},getUserAgent:function(){return navigator.userAgent}}})});"use strict";d.now("ARAAddMetric").execute(function(b){b||d.register("ARAAddMetric",
function(){return{addMetric:function(b,a){c.ue&&c.ue.count&&c.ue.count(b,a)}}})});"use strict";d.now("ARALogError").execute(function(b){b||d.register("ARALogError",function(){return{logError:function(b){var a={logLevel:2<arguments.length&&arguments[2]!==g?arguments[2]:"ERROR",attribution:"ARARegisterTrigger",message:1<arguments.length&&arguments[1]!==g?arguments[1]:""};c.ueLogError&&c.ueLogError(b,a);return[b,a]}}})});"use strict";d.now("ARAUtils").execute(function(b){b||d.register("ARAUtils",function(){function b(){return c.opts}
var a=/development|beta/,f=/pre-prod|gamma/,d={"Google Chrome":106};return{getWindowOpts:b,getHref:function(){return c.location.href},getStage:function(b){return a.test(b)?"beta":f.test(b)?"gamma":"prod"},getCustomerId:function(){return b().customerId},getSessionId:function(){return b().sessionId},getNavigator:function(){return navigator},registerFetch:function(a){return c.fetch(a,{keepalive:!0,attributionReporting:{eventSourceEligible:!1,triggerEligible:!0}})},checkIsBrowserSupported:function(){var a=
navigator.userAgentData;if(null==a)return!1;a=a.brands;a:{if(a&&0!==a.length){var b=!0,h=!1,f=g;try{for(var c=a[Symbol.iterator](),l;!(b=(l=c.next()).done);b=!0){var k=l.value;if(Number.parseFloat(k.version)>=d[k.brand]){var m=!0;break a}}}catch(p){h=!0,f=p}finally{try{!b&&c.return&&c.return()}finally{if(h)throw f;}}}m=!1}return m},checkIsFeatureAllowed:function(){return"featurePolicy"in document&&"function"===typeof document.featurePolicy.allowsFeature?document.featurePolicy.allowsFeature("attribution-reporting"):
!1},getDetailPageState:function(){if(c.DetailPage&&c.DetailPage.StateController)return c.DetailPage.StateController.getState()}}})});"use strict";d.now("ARARegisterTriggerHelpers").execute(function(b){b||d.when("ARAConfiguration","ARAAddMetric","ARALogError","ARAUtils").register("ARARegisterTriggerHelpers",function(b,a,f,c){function d(a){switch(a){case "beta":return"https://beta-ara.paa-reporting-advertising.amazon";case "gamma":return"https://gamma-ara.paa-reporting-advertising.amazon";case "prod":return"https://ara.paa-reporting-advertising.amazon"}}
function e(b,d,l,n){return c.registerFetch(b).then(function(c){if(d<l)return c.ok?(a.addMetric("ARA:RegisterDPVResponseRecieved",1),c.json()):new Promise(function(a,c){setTimeout(function(){e(b,d+1,l,2*n).then(a).catch(c)},n)});throw Error("Exceeded maximum retries");}).catch(function(b){a.addMetric("ARA:RegisterDPVResponseError",1);f.logError(b,"ARA:RegisterDPVResponseError. Error receiving response from ARAService")})}return{generateGatewayUrl:d,browserSupportsARA:function(){var b=!0,d=c.checkIsBrowserSupported();
d||a.addMetric("ARA:UserAgentNotSupported",1);var f=c.checkIsFeatureAllowed();f||a.addMetric("ARA:ARAFeatureNotEnabled",1);d&&f||(b=!1);return b},registerTrigger:e,createQueryParams:function(a,b){b=d(b)+"/conversion?";var c={asin:a.pageInformation.asin,eventType:"dpv",debugKey:a.identity.customerId,marketId:1,requestId:a.identity.requestId},f=encodeURIComponent;a=Object.keys(c).map(function(a){return f(a)+"\x3d"+f(c[a])}).join("\x26");return b+a}}})});"use strict";d.now("DetailedPageInfo").execute(function(b){b||
(d.when("A").register("DetailedPageInfo",function(b){var a={init:function(b,c,d,e,h){a.config=b;a.helpers=e;a.utils=h;a.metrics=c;a.errors=d;a.retrieveDPV()},retrieveDPV:function(){var b=a.utils.getHref();if(b){var c=a.utils.getDetailPageState();if(c&&c.current_asin){c=c.current_asin;var d=a.utils.getStage(b);if(a.helpers.browserSupportsARA()){a.metrics.addMetric("ARA:BrowserSupportsARA:True",1);var e=a.utils.getWindowOpts();if(e){var h=a.utils.getSessionId(),g=e.pageType,m=a.utils.getCustomerId(),
n=e.obfuscatedMarketId;e=e.requestId;var k=a.config.getRoboticSessionId();(k=h===k)?a.metrics.addMetric("ARA:TotalPunts",1):(b=a.helpers.createQueryParams({identity:{sessionId:h,customerId:m,requestId:e},pageInformation:{pageURL:b,pageType:g,asin:c,obfuscatedMarketId:n}},d),a.helpers.registerTrigger(b,0,5,100),a.metrics.addMetric("ARA:BrowserSupportsARA:DPV",1));k&&a.metrics.addMetric("ARA:RoboticTraffic:True",1)}else a.metrics.addMetric("ARA:OptsNotFoundError",1),b={message:"ARA:OptsNotFoundError. Error getting windowOpts."},
a.errors.logError(b)}else a.metrics.addMetric("ARA:BrowserSupportsARA:False",1)}else a.metrics.addMetric("ARA:DetailPageStateNotFoundError",1),b={message:"ARA:DetailPageStateNotFoundError. Error getting DetailPage state."},a.errors.logError(b)}else a.metrics.addMetric("ARA:PageLoadError",1),b={message:"ARA:PageLoadError. Error retrieving url from window."},a.errors.logError(b)}};b.on("PageRefresh:ATF",function(){a.metrics.addMetric("ARA:DPVTwisterEventCaptured",1);a.retrieveDPV()});return a}),d.when("ARAConfiguration",
"ARAAddMetric","ARALogError","ARARegisterTriggerHelpers","ARAUtils","DetailedPageInfo","ready").execute(function(b,a,c,d,g,e){e.init(b,a,c,d,g)}))})});